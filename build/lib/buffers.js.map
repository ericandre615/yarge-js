{"version":3,"file":"buffers.js","sourceRoot":"","sources":["../../src/lib/buffers.js"],"names":[],"mappings":"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","sourcesContent":["const createBuffer = gl => (BUFFER_TYPE) => {\n  const bufferId = gl.createBuffer();\n\n  return {\n    bufferId,\n    bind: () => gl.bindBuffer(BUFFER_TYPE, bufferId),\n    unbind: () => gl.bindBuffer(BUFFER_TYPE, null),\n    detach: () => gl.deleteBuffer(1, bufferId),\n    staticDrawData: (bufferData) => {\n      gl.bufferData(\n        BUFFER_TYPE,\n        bufferData,\n        gl.STATIC_DRAW\n      );\n    },\n  };\n};\n\nexport const createVertexArray = gl => {\n  const ext = (\n    gl.getExtension('OES_vertex_array_object') ||\n    gl.getExtension('MOZ_OES_vertex_array_object') ||\n    gl.getExtension('WEBKIT_OES_vertex_array_object')\n  );\n\n  const bufferId = ext.createVertexArrayOES();\n\n  return {\n    bufferId,\n    bind: () => ext.bindVertexArrayOES(bufferId),\n    unbind: () => ext.bindVertexArrayOES(null),\n    detach: () => ext.deleteVertexArrayOES(bufferId),\n  };\n};\n\nexport const createDynamicArrayBuffer = gl => {\n  const bufferId = gl.createBuffer();\n  const bufferOffset = 0;\n\n  return {\n    bufferId,\n    bind: () => gl.bindBuffer(gl.ARRAY_BUFFER, bufferId),\n    unbind: () => gl.bindBuffer(gl.ARRAY_BUFFER, null),\n    detach: () => gl.deleteBuffer(1, bufferId),\n\n    setBufferOffse: offset => { bufferOffset = offset; },\n    resetBufferOffset: () => { bufferOffset = 0; },\n    getBufferOffset: () => bufferOffset,\n    setBufferData: maxBufferSize => {\n      gl.bufferData(\n        gl.ARRAY_BUFFER,\n        maxBufferSize,\n        null, //?\n        gl.DYNAMIC_DRAW,\n      );\n    },\n    uploadDrawData: data => {\n      gl.bufferSubData(\n        gl.ARRAY_BUFFER,\n        bufferOffset,\n        //data.length(), // >_size_in_bytes? webgl 1 doesn't use this?\n        data,\n      );\n    },\n  }\n};\n\nexport const createArrayBuffer = gl => createBuffer(gl)(gl.ARRAY_BUFFER);\nexport const createElementArrayBuffer = gl => createBuffer(gl)(gl.ELEMENT_ARRAY_BUFFER);\n\nexport default {\n  createArrayBuffer,\n  createElementArrayBuffer,\n  createVertexArray,\n};\n\n"]}