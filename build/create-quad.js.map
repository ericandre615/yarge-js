{"version":3,"file":"create-quad.js","sourceRoot":"","sources":["../src/create-quad.ts"],"names":[],"mappings":"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","sourcesContent":["import type { Camera } from './lib/camera';\n\nimport createProgram from './lib/program.js';\nimport { createArrayBuffer, createVertexArray, createElementArrayBuffer } from './lib/buffers.js';\nimport { vertex as createVertex, vertexArray } from './lib/vertex.js';\nimport { vertexShader, fragmentShader } from './shaders/quad.js';\n\nexport const createQuad = (gl: WebGLRenderingContext) => ({\n  position = [0.0, 0.0, 0.0],\n  color = [0.0, 0.0, 0.0, 0.0],\n  width = 0,\n  height = 0,\n}) => {\n  const program = createProgram(gl)(vertexShader, fragmentShader);\n  const uniform_mvp = program.getUniformLocation('mvp');\n  const a_position = program.getAttribLocation('a_position');\n  const a_color = program.getAttribLocation('a_color');\n\n  const [x, y, z] = position;\n  const x2 = x + width;\n  const y2 = y + height;\n\n  const vertex = createVertex(gl);\n  const vertices = vertexArray([\n    vertex({ [a_position]: [x, y, z], [a_color]: color }),\n    vertex({ [a_position]: [x2, y, z], [a_color]: color }),\n    vertex({ [a_position]: [x, y2, z], [a_color]: color }),\n    vertex({ [a_position]: [x2, y2, z], [a_color]: color }),\n  ]);\n  const indices = [0, 1, 2, 2, 1, 3];\n  const vbo = createArrayBuffer(gl);\n  const ibo = createElementArrayBuffer(gl);\n  const vao = createVertexArray(gl);\n\n  vbo.bind();\n  vbo.staticDrawData(vertices.data);\n\n  vao.bind();\n\n  vertices.vertexAttribPointers(program);\n\n  ibo.bind();\n  ibo.staticDrawData(new Uint16Array(indices));\n  ibo.unbind();\n\n  vao.unbind();\n  vbo.unbind();\n\n  return {\n    render: (camera: Camera) => {\n      const vp = camera.getViewProjection();\n      program.setUsed();\n      program.setUniformMat4f(uniform_mvp, vp);\n\n      vao.bind();\n\n      ibo.bind();\n\n      gl.drawElements(\n        gl.TRIANGLES,\n        indices.length,\n        gl.UNSIGNED_SHORT,\n        0\n      );\n\n      ibo.unbind();\n      vao.unbind();\n\n      return;\n    },\n  };\n};\n\nexport default createQuad;\n"]}