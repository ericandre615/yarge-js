{"version":3,"file":"create-triangle.js","sourceRoot":"","sources":["../src/create-triangle.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA,OAAO,aAAa,MAAM,kBAAkB,CAAC;AAC7C,OAAO,EAAE,iBAAiB,EAAE,iBAAiB,EAAE,wBAAwB,EAAE,MAAM,kBAAkB,CAAC;AAClG,OAAO,EAAE,MAAM,IAAI,YAAY,EAAE,WAAW,EAAE,MAAM,iBAAiB,CAAC;AACtE,OAAO,EAAE,YAAY,EAAE,cAAc,EAAE,MAAM,uBAAuB,CAAC;AAOrE,MAAM,CAAC,IAAM,cAAc,GAAG,UAAC,EAAyB,IAAK,OAAA,UAAC,GAAa,EAAE,KAAW;;IACtF,IAAM,OAAO,GAAG,aAAa,CAAC,EAAE,CAAC,CAAC,YAAY,EAAE,cAAc,CAAC,CAAC;IAChE,IAAM,UAAU,GAAG,OAAO,CAAC,iBAAiB,CAAC,YAAY,CAAC,CAAC;IAC3D,IAAM,OAAO,GAAG,OAAO,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;IACrD,IAAM,MAAM,GAAG,YAAY,CAAC,EAAE,CAAC,CAAC;IAC1B,IAAA,KAAA,OAAY,GAAG,IAAA,EAAd,CAAC,QAAA,EAAE,CAAC,QAAA,EAAE,CAAC,QAAO,CAAC;IACtB,IAAM,QAAQ,GAAG,WAAW,CAAC;QAC3B,MAAM,WAAG,GAAC,UAAU,IAAG,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC,EAAE,GAAC,OAAO,IAAG,KAAK,MAAG;QAC7D,MAAM,WAAG,GAAC,UAAU,IAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,EAAE,GAAC,OAAO,IAAG,KAAK,MAAG;QAC3D,MAAM,WAAG,GAAC,UAAU,IAAG,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC,EAAE,GAAC,OAAO,IAAG,KAAK,MAAG;KAC7D,CAAC,CAAC;IACH,IAAM,OAAO,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAE1B,IAAM,GAAG,GAAG,iBAAiB,CAAC,EAAE,CAAC,CAAC;IAClC,IAAM,GAAG,GAAG,wBAAwB,CAAC,EAAE,CAAC,CAAC;IACzC,IAAM,GAAG,GAAG,iBAAiB,CAAC,EAAE,CAAC,CAAC;IAElC,GAAG,CAAC,IAAI,EAAE,CAAC;IACX,GAAG,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;IAElC,GAAG,CAAC,IAAI,EAAE,CAAC;IAEX,QAAQ,CAAC,oBAAoB,CAAC,OAAO,CAAC,CAAC;IAEvC,GAAG,CAAC,IAAI,EAAE,CAAC;IACX,GAAG,CAAC,cAAc,CAAC,IAAI,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC;IAC7C,GAAG,CAAC,MAAM,EAAE,CAAC;IAEb,GAAG,CAAC,MAAM,EAAE,CAAC;IACb,GAAG,CAAC,MAAM,EAAE,CAAC;IAEb,OAAO;QACL,MAAM,EAAE,UAAC,MAAc;YACrB,IAAM,UAAU,GAAG,MAAM,CAAC,aAAa,EAAE,CAAC;YAE1C,OAAO,CAAC,OAAO,EAAE,CAAC;YAElB,GAAG,CAAC,IAAI,EAAE,CAAC;YAEX,GAAG,CAAC,IAAI,EAAE,CAAC;YAEX,EAAE,CAAC,YAAY,CACb,EAAE,CAAC,SAAS,EACZ,OAAO,CAAC,MAAM,EACd,EAAE,CAAC,cAAc,EACjB,CAAC,CACF,CAAC;YAEF,GAAG,CAAC,MAAM,EAAE,CAAC;YACb,GAAG,CAAC,MAAM,EAAE,CAAC;YAEb,OAAO;QACT,CAAC;KACF,CAAC;AACJ,CAAC,EAtD4D,CAsD5D,CAAC;AAEF,eAAe,cAAc,CAAC","sourcesContent":["import createProgram from './lib/program.js';\nimport { createArrayBuffer, createVertexArray, createElementArrayBuffer } from './lib/buffers.js';\nimport { vertex as createVertex, vertexArray } from './lib/vertex.js';\nimport { vertexShader, fragmentShader } from './shaders/triangle.js';\n\nimport type { RGBA } from './lib/color';\nimport type { Camera } from './lib/camera';\n\ntype Position = [number, number, number];\n\nexport const createTriangle = (gl: WebGLRenderingContext) => (pos: Position, color: RGBA) => {\n  const program = createProgram(gl)(vertexShader, fragmentShader);\n  const a_position = program.getAttribLocation('a_position');\n  const a_color = program.getAttribLocation('a_color');\n  const vertex = createVertex(gl);\n  const [x, y, z] = pos;\n  const vertices = vertexArray([\n    vertex({ [a_position]: [-0.5, -0.5, 0.0], [a_color]: color }),\n    vertex({ [a_position]: [0.5, 0.0, 0.0], [a_color]: color }),\n    vertex({ [a_position]: [0.5, -0.5, 0.0], [a_color]: color }),\n  ]);\n  const indices = [0, 1, 2];\n\n  const vbo = createArrayBuffer(gl);\n  const ibo = createElementArrayBuffer(gl);\n  const vao = createVertexArray(gl);\n\n  vbo.bind();\n  vbo.staticDrawData(vertices.data);\n\n  vao.bind();\n\n  vertices.vertexAttribPointers(program);\n\n  ibo.bind();\n  ibo.staticDrawData(new Uint16Array(indices));\n  ibo.unbind();\n\n  vao.unbind();\n  vbo.unbind();\n\n  return {\n    render: (camera: Camera) => {\n      const projection = camera.getProjection();\n\n      program.setUsed();\n\n      vao.bind();\n\n      ibo.bind();\n\n      gl.drawElements(\n        gl.TRIANGLES,\n        indices.length,\n        gl.UNSIGNED_SHORT,\n        0\n      );\n\n      ibo.unbind();\n      vao.unbind();\n\n      return;\n    },\n  };\n};\n\nexport default createTriangle;\n"]}